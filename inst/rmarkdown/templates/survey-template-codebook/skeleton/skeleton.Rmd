---
title: "RAAMP-GBV Assessment"
output:
  pdf_document:
    toc: yes
    toc_depth: 4
  html_document:
    toc: true
    toc_depth: 4
    toc_float: true
    code_folding: 'hide'
    self_contained: true
params:
  state: NULL
  toolType: NULL
---

```{r setup}
knitr::opts_chunk$set(
  warning = TRUE,
  message = TRUE,
  error = TRUE, 
  echo = FALSE
)
ggplot2::theme_set(ggplot2::theme_bw())
pander::panderOptions("table.split.table", Inf)
```

```{r pkg-loading, message=FALSE}
library(codebook)
library(raampGBV)
```

Codebook for data collected from administration of survey questionnaire:

**State**: `r params$state`
**Sector or Tool type**: `r params$toolType`

```{r prepare_codebook}
raampDir <- make_dir_tree()

## TODO: Abstract this operation away from this location
stateFpath <- .removeSpaceForFilepath(params$state)
codebook_data <-
  readRDS(file.path(
    raampDir$quant,
    stateFpath,
    sprintf(
      "fullyLabelledData__%s_%s.rds",
      stateFpath,
      params$toolType
    )
  ))


codebook_data <- detect_missing(
  codebook_data,
  only_labelled = TRUE,
  negative_values_are_missing = FALSE,
  ninety_nine_problems = TRUE,
)

# codebook_data <- detect_scales(codebook_data)
```

  
```{r build-codebook}
codebook(codebook_data)
```
